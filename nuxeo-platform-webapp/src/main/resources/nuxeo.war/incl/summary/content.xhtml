<div class="content_block"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:nxl="http://nuxeo.org/nxforms/layout">

  <h3 class="summaryTitle">
    <h:outputText value="#{messages['action.view.content']}" />
  </h3>

  <h:panelGrid columns="2">

    <h:panelGroup rendered="#{currentDocument.hasSchema('file') and !empty currentDocument.file.content}">
      <h:outputText class="boldLabel" value="#{messages['label.summary.download.file']}" />
      <br/>
      <nxh:outputLink class="boldLabel"
        value="#{nxd:fileUrl('downloadFile', currentDocument, 'file:content', currentDocument.file.filename)}">
        <h:outputText value="#{currentDocument.file.filename}"/>
        <nxh:graphicImage value="/icons/download.png" title="#{row.data.file.filename}"/>
      </nxh:outputLink>
      <c:if test="#{conversionActions.pdfConverterAvailability.available}">
        <nxu:methodResult name="hasPDFCapabilities" value="#{conversionActions.isFileExportableToPDF('file:content')}">
          <h:panelGroup rendered="#{hasPDFCapabilities}">
            <h:outputText value=" #{messages['label.summary.download.other']} "/>
            <h:commandLink action="#{conversionActions.generatePdfFile}">
              <f:param name="fileFieldFullName" value="file:content" />
              <f:param name="filename" value="#{currentDocument.file.filename}" />
              <h:outputText value="#{currentDocument.file.filename}"/>
              <nxh:graphicImage value="/icons/pdf.png" title="#{currentDocument.file.filename}" />
            </h:commandLink>
          </h:panelGroup>
        </nxu:methodResult>
      </c:if>
    </h:panelGroup>

    <h:panelGroup rendered="#{currentDocument.hasSchema('files')  and (!empty currentDocument.files.files)}">
      <h:outputText class="boldLabel" value=" #{messages['label.summary.download.attachments']}"/>
      <br/>

      <div class="attachments">
        <nxu:inputList value="#{currentDocument.files.files}"  id="files_input" model="model">
          <div class="detailList">

            <nxh:outputLink value="#{nxd:complexFileUrl('downloadFile', currentDocument, 'files:files', model.rowIndex, 'file', currentDocument.files.files[model.rowIndex].filename)}">
              <nxh:graphicImage value="#{nxd:fileIconPath(currentDocument.files.files[model.rowIndex].file)}"
                rendered="#{! empty nxd:fileIconPath(currentDocument.files.files[model.rowIndex].file)}" />
              <nxh:outputText value="#{currentDocument.files.files[model.rowIndex].filename}" />
            </nxh:outputLink>
  
            <nxu:methodResult name="hasPDFCapabilities"
              value="#{conversionActions.isExportableToPDF(currentDocument.files.files[model.rowIndex].file)}">
              <h:panelGroup rendered="#{hasPDFCapabilities}">
                <h:outputText value=" | " />
                <h:commandLink action="#{conversionActions.generatePdfFile}">
                  <f:param name="fileFieldFullName"
                    value="#{nxd:propertyPath('files:files', model.rowIndex, 'file')}" />
                  <f:param name="filename" value="#{currentDocument.files.files[model.rowIndex].filename}" />
                  <h:outputText value="#{messages['label.document.generatePdf']}" />
                </h:commandLink>
              </h:panelGroup>
            </nxu:methodResult>

          </div>
        </nxu:inputList>
      </div>

    </h:panelGroup>
  </h:panelGrid>

</div>